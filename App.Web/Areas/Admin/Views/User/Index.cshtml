@using App.Core.Models.Entities;
@using App.Web.Models.UI.Admin;
@using App.Core.Models.Inputs;
@model List<UserViewModel>
@{
    ViewBag.PageTitle = "User Manager";

    var breadcrumb = new List<BreadCrumbViewModel>()
{
        new BreadCrumbViewModel()
        {
            Name = "Account", IsActive = false
        },

        new BreadCrumbViewModel()
        {
            Name = "Users", IsActive = true, Url = Url.Action("Index", "User", new { area = "Admin" })
        }
    };
}
@Html.Partial("~/Areas/Admin/Views/Partial/Role/_CreateRoleModal.cshtml", new RoleViewModel())

<div class="content d-flex flex-column flex-column-fluid" id="kt_content">
    <!--begin::Subheader-->
    <div class="subheader py-2 py-lg-6  subheader-solid " id="kt_subheader">
        <div class=" container-fluid  d-flex align-items-center justify-content-between flex-wrap flex-sm-nowrap">
            <!--begin::Info-->
            <div class="d-flex align-items-center flex-wrap mr-1">

                <!--begin::Page Heading-->
                <div class="d-flex align-items-baseline flex-wrap mr-5">
                    @Html.Partial("~/Areas/Admin/Views/Partial/_BreadCrumb.cshtml", breadcrumb)
                </div>
            </div>
            <div class="d-flex align-items-center">
                <!--begin::Button-->
                <a href="#" class="">

                </a>
                <!--end::Button-->
                <!--begin::Button-->
                <a href="@Url.Action("Create", "User", new { area = "Admin" })" class="btn btn-light-primary font-weight-bold btn-sm px-4 font-size-base ml-2">
                    Create User
                </a>
            </div>
            <!--end::Info-->
        </div>
    </div>
    <!--end::Subheader-->
    <!--begin::Entry-->
    <div class="d-flex flex-column-fluid">
        <!--begin::Container-->
        <div class=" container ">
            @Html.Partial("~/Areas/Admin/Views/Partial/_Notification.cshtml")
            @if (Model.Count > 0)
            {
                <div class="card card-custom gutter-b">
                    <div class="card-body">
                        <!--begin: Datatable-->
                        <table class="table table-separate table-head-custom collapsed" id="kt_datatable">
                            <thead>
                                <tr>
                                    <th>Names</th>
                                    <th>Email</th>
                                    <th>Phone</th>
                                    <th>Date Created</th>
                                    <th>Roles</th>
                                    <th>Status</th>
                                    <th>Actions</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var record in Model)
                                {
                                    <tr>

                                        <td>@string.Format("{0} {1} {2}", record.LastName ?? string.Empty, record.FirstName ?? string.Empty, record.OtherName ?? string.Empty)</td>
                                        <td>@record.Email</td>
                                        <td>@(record.PhoneNumber ?? "N/A")</td>
                                        <td>@record.DateCreated.ToString()</td>
                                        <td>
                                            @foreach (var role in record.RoleVMs)
                                            {
                                                if (!string.IsNullOrEmpty(role.Color))
                                                {
                                                    <span class="label label-inline mr-2" style="background-color: @role.Color; color: white;">@role.Name</span>
                                                }
                                                else
                                                {
                                                    <span class="label label-inline label-default mr-2">@role.Name</span>
                                                }
                                            }
                                        <td>
                                            @if (record.IsActive)
                                            {
                                                <span class="badge badge-success">Active</span>
                                            }
                                            else
                                            {
                                                <span class="badge badge-secondary">Inactive</span>
                                            }
                                            &nbsp;

                                            @if (record.LockoutEnabled)
                                            {
                                                <span class="badge badge-warning">Locked</span>
                                            }
                                        </td>
                                        <td nowrap">
                                            <a href="@Url.Action("Edit", "User", new { area = "Admin", Id = record.ID })" class="btn btn-sm btn-clean btn-icon" title="Edit details">
                                                <i class="la la-edit"></i>
                                            </a>
                                            <a href="javascript:;" class="btn btn-sm btn-clean btn-icon" title="Delete">
                                                <i class="la la-trash"></i>
                                            </a>
                                        </td>
                                    </tr>
                                }
                            </tbody>
                        </table>
                        <!--end: Datatable-->
                    </div>
                </div>
            }
            else
            {
                <div class="card card-custom gutter-b p-6 mb-8 mb-lg-0">
                    <div class="card-body">
                        <div class="d-flex align-items-center justify-content-between p-4 flex-lg-wrap flex-xl-nowrap">
                            <div class="d-flex flex-column mr-5">
                                <a class="h4 text-dark mb-5">
                                    No Record Found
                                </a>
                                <p class="text-dark-50">
                                    No available record at the moment. Try setting up new record.
                                </p>
                            </div>
                            <div class="ml-6 ml-lg-0 ml-xxl-6 flex-shrink-0">
                                <a data-toggle="modal" data-target="#role-setup-modal" class="btn font-weight-bolder text-uppercase btn-primary py-4 px-6">
                                    Create Role
                                </a>
                            </div>
                        </div>

                    </div>
                </div>
            }
        </div>
        <!--end::Container-->
    </div>
    <!--end::Entry-->
</div>
@section page_css{
    @Styles.Render("~/assets/ladda/css")
    <link href="assets/plugins/custom/datatables/datatables.bundle.css" rel="stylesheet" type="text/css" />
}

@section page_js{
    @Scripts.Render("~/assets/ladda/js")
    <script src="assets/plugins/custom/datatables/datatables.bundle.js"></script>
    <script src="assets/js/pages/crud/datatables/extensions/responsive.js"></script>

    <script>
        $(document).ready(function () {
            Ladda.bind('.ladda-button');
        });
    </script>
}